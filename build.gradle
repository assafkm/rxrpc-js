apply from: "$scriptsDir/nodejs.gradle"

yarnBuild {
    inputs.dir "$projectDir/src"
    inputs.file "$projectDir/tsconfig.json"
    outputs.dir "$projectDir/dist"
}

def packageOutput = "${buildDir}/${project.name}.tgz"
project.ext.packageFile = project.file(packageOutput)

yarnPack {
    args += ['--filename', packageOutput]
    outputs.file packageOutput
}

project.afterEvaluate { yarn.dependsOn(createYarnWrapperScripts) }

task deleteBuildFiles(type: Delete) {
    delete "$projectDir/dist", "$project.buildDir"
}

clean.dependsOn(deleteBuildFiles)
